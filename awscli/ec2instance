#AWS EC2 Creation through AWS CLI

#Choose an AMI (Amazon Machine Image)

aws ec2 describe-images \
  --owners amazon \
  --filters "Name=name,Values=amzn2-ami-hvm-*-x86_64-gp2" \
  --query "Images[*].[ImageId,CreationDate]" \
  --output table

#Example:

ami-0abcdef1234567890

#Create a Key Pair (for SSH)
aws ec2 create-key-pair \
  --key-name my-keypair \
  --query "KeyMaterial" \
  --output text > my-keypair.pem


#Set permissions:

chmod 400 my-keypair.pem



#Create a Security Group

aws ec2 create-security-group \
  --group-name my-sg \
  --description "Allow SSH access"
  
  
#Allow SSH (port 22)

aws ec2 authorize-security-group-ingress \
  --group-name my-sg \
  --protocol tcp \
  --port 22 \
  --cidr 0.0.0.0/0



#Create (Run) EC2 Instance âœ…

aws ec2 run-instances \
  --image-id ami-0abcdef1234567890 \
  --instance-type t2.micro \
  --key-name my-keypair \
  --security-groups my-sg \
  --count 1 \
  --tag-specifications 'ResourceType=instance,Tags=[{Key=Name,Value=MyCLIInstance}]'
  
  
 
 #If you already have existing SG & Keypair
  
  aws ec2 describe-key-pairs \
  --query "KeyPairs[*].KeyName" \
  --output table
  

aws ec2 describe-security-groups \
  --query "SecurityGroups[*].[GroupName,GroupId]" \
  --output table
  

#List instances
aws ec2 describe-instances \
  --query "Reservations[*].Instances[*].[InstanceId,State.Name,PublicIpAddress]" \
  --output table
  
  #Connect to EC2 (SSH)
ssh -i my-keypair.pem ec2-user@<PUBLIC-IP>

# Stop or Terminate Instance
#Stop
aws ec2 stop-instances --instance-ids i-0123456789abcdef0

#Terminate
aws ec2 terminate-instances --instance-ids i-0123456789abcdef0
